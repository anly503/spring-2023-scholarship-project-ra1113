<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data Cleaning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="data-cleaning_files/libs/clipboard/clipboard.min.js"></script>
<script src="data-cleaning_files/libs/quarto-html/quarto.js"></script>
<script src="data-cleaning_files/libs/quarto-html/popper.min.js"></script>
<script src="data-cleaning_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="data-cleaning_files/libs/quarto-html/anchor.min.js"></script>
<link href="data-cleaning_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="data-cleaning_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="data-cleaning_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="data-cleaning_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="data-cleaning_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#import-and-merge-json-files" id="toc-import-and-merge-json-files" class="nav-link active" data-scroll-target="#import-and-merge-json-files"><span class="toc-section-number">1</span>  Import and Merge JSON files</a></li>
  <li><a href="#clean-data" id="toc-clean-data" class="nav-link" data-scroll-target="#clean-data"><span class="toc-section-number">2</span>  Clean Data</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data Cleaning</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pandas.io.json <span class="im">import</span> json_normalize</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="import-and-merge-json-files" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="import-and-merge-json-files"><span class="header-section-number">1</span> Import and Merge JSON files</h2>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(os.getcwd())</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#os.chdir('/Users/raunakadvani/2023-anly503-ra1113/spring-2023-scholarship-project-raunakadvani2410/data/2023-04-14-job-search/2023-04-14-job-search-location-DC')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/Users/raunakadvani/2023-anly503-ra1113/spring-2023-scholarship-project-raunakadvani2410/code/data_cleaning</code></pre>
</div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> merge_jobs_results(directory): <span class="co"># merge all jsons from a folder</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialize an empty list to hold the dfs</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    dfs <span class="op">=</span> []</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># iterate over all files in the directory</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> filename <span class="kw">in</span> os.listdir(directory):</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> filename.endswith(<span class="st">'.json'</span>):</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>            <span class="co"># read in the json data from the file</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>            filepath <span class="op">=</span> os.path.join(directory, filename)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                json_data <span class="op">=</span> json.load(f)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>            <span class="co"># extract 'jobs_results' and convert to a df</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>            jobs_data <span class="op">=</span> json_data.get(<span class="st">'jobs_results'</span>, [])</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>            df <span class="op">=</span> pd.json_normalize(jobs_data)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>            df[<span class="st">'key'</span>] <span class="op">=</span> filename[:<span class="op">-</span><span class="dv">7</span>] <span class="co"># add column for search key, taken from file name</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>            <span class="co"># add the df to the list</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>            dfs.append(df)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># concatenate into a single df</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    merged_df <span class="op">=</span> pd.concat(dfs, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> merged_df    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> merge_jobs_results(<span class="st">'../../data/2023-04-14-job-search/2023-04-14-job-search-location-DC/'</span>) <span class="co"># DC jobs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> merged.drop(<span class="st">'detected_extensions.commute_time'</span>, axis<span class="op">=</span><span class="dv">1</span>).copy() <span class="co"># drop last column so that both folders' files' dimensions match</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>merged.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>title</th>
      <th>company_name</th>
      <th>location</th>
      <th>via</th>
      <th>description</th>
      <th>job_highlights</th>
      <th>related_links</th>
      <th>extensions</th>
      <th>job_id</th>
      <th>detected_extensions.schedule_type</th>
      <th>detected_extensions.work_from_home</th>
      <th>detected_extensions.posted_at</th>
      <th>detected_extensions.salary</th>
      <th>key</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ethereum Blockchain Developer (Remote)</td>
      <td>Ex Populus</td>
      <td>Anywhere</td>
      <td>via Built In</td>
      <td>Company Overview:\nEx Populus is a cutting-edg...</td>
      <td>[{'title': 'Qualifications', 'items': ['2-3 ye...</td>
      <td>[{'link': 'https://www.google.com/search?hl=en...</td>
      <td>[Work from home, Full-time, No degree mentioned]</td>
      <td>eyJqb2JfdGl0bGUiOiJFdGhlcmV1bSBCbG9ja2NoYWluIE...</td>
      <td>Full-time</td>
      <td>True</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>block-chain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Blockchain Engineer</td>
      <td>21.co</td>
      <td>New York, NY</td>
      <td>via Greenhouse</td>
      <td>We are seeking a highly motivated and skilled ...</td>
      <td>[{'title': 'Qualifications', 'items': ['Bachel...</td>
      <td>[{'link': 'https://www.google.com/search?hl=en...</td>
      <td>[Full-time]</td>
      <td>eyJqb2JfdGl0bGUiOiJCbG9ja2NoYWluIEVuZ2luZWVyIi...</td>
      <td>Full-time</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>block-chain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Blockchain Course Instructor</td>
      <td>Blockchain Institute of Technology</td>
      <td>Anywhere</td>
      <td>via LinkedIn</td>
      <td>Are you a blockchain, cryptocurrency, NFT, Met...</td>
      <td>[{'title': 'Qualifications', 'items': ['3+ yea...</td>
      <td>[{'link': 'https://www.google.com/search?hl=en...</td>
      <td>[24 hours ago, Work from home, Contractor, No ...</td>
      <td>eyJqb2JfdGl0bGUiOiJCbG9ja2NoYWluIENvdXJzZSBJbn...</td>
      <td>Contractor</td>
      <td>True</td>
      <td>24 hours ago</td>
      <td>NaN</td>
      <td>block-chain</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>merged1 <span class="op">=</span> merge_jobs_results(<span class="st">'../../data/2023-04-14-job-search/2023-04-14-job-search-location-USA/'</span>) <span class="co"># USA jobs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>merged_df <span class="op">=</span> pd.concat([merged, merged1], ignore_index<span class="op">=</span><span class="va">True</span>) <span class="co"># concatenate DC and USA jobs</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>merged_df.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>title</th>
      <th>company_name</th>
      <th>location</th>
      <th>via</th>
      <th>description</th>
      <th>job_highlights</th>
      <th>related_links</th>
      <th>extensions</th>
      <th>job_id</th>
      <th>detected_extensions.schedule_type</th>
      <th>detected_extensions.work_from_home</th>
      <th>detected_extensions.posted_at</th>
      <th>detected_extensions.salary</th>
      <th>key</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ethereum Blockchain Developer (Remote)</td>
      <td>Ex Populus</td>
      <td>Anywhere</td>
      <td>via Built In</td>
      <td>Company Overview:\nEx Populus is a cutting-edg...</td>
      <td>[{'title': 'Qualifications', 'items': ['2-3 ye...</td>
      <td>[{'link': 'https://www.google.com/search?hl=en...</td>
      <td>[Work from home, Full-time, No degree mentioned]</td>
      <td>eyJqb2JfdGl0bGUiOiJFdGhlcmV1bSBCbG9ja2NoYWluIE...</td>
      <td>Full-time</td>
      <td>True</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>block-chain</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Blockchain Engineer</td>
      <td>21.co</td>
      <td>New York, NY</td>
      <td>via Greenhouse</td>
      <td>We are seeking a highly motivated and skilled ...</td>
      <td>[{'title': 'Qualifications', 'items': ['Bachel...</td>
      <td>[{'link': 'https://www.google.com/search?hl=en...</td>
      <td>[Full-time]</td>
      <td>eyJqb2JfdGl0bGUiOiJCbG9ja2NoYWluIEVuZ2luZWVyIi...</td>
      <td>Full-time</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>block-chain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Blockchain Course Instructor</td>
      <td>Blockchain Institute of Technology</td>
      <td>Anywhere</td>
      <td>via LinkedIn</td>
      <td>Are you a blockchain, cryptocurrency, NFT, Met...</td>
      <td>[{'title': 'Qualifications', 'items': ['3+ yea...</td>
      <td>[{'link': 'https://www.google.com/search?hl=en...</td>
      <td>[24 hours ago, Work from home, Contractor, No ...</td>
      <td>eyJqb2JfdGl0bGUiOiJCbG9ja2NoYWluIENvdXJzZSBJbn...</td>
      <td>Contractor</td>
      <td>True</td>
      <td>24 hours ago</td>
      <td>NaN</td>
      <td>block-chain</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="clean-data" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="clean-data"><span class="header-section-number">2</span> Clean Data</h2>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df_highlights <span class="op">=</span> pd.json_normalize(merged_df[<span class="st">'job_highlights'</span>]) <span class="co"># break up job highlights</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>df_highlights.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>{'title': 'Qualifications', 'items': ['2-3 yea...</td>
      <td>{'title': 'Responsibilities', 'items': ['Desig...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>{'title': 'Qualifications', 'items': ['Bachelo...</td>
      <td>{'title': 'Responsibilities', 'items': ['As a ...</td>
      <td>{'title': 'Benefits', 'items': ['(NYC only) Pu...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>{'title': 'Qualifications', 'items': ['3+ year...</td>
      <td>{'title': 'Responsibilities', 'items': ['Our e...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>{'title': 'Qualifications', 'items': ['Candida...</td>
      <td>{'title': 'Responsibilities', 'items': ['Will ...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>{'title': 'Qualifications', 'items': ['You are...</td>
      <td>{'title': 'Responsibilities', 'items': ['To bu...</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_items_value(dictionary): <span class="co"># get item value</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pd.isnull(dictionary): <span class="co"># deal with na values</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dictionary[<span class="st">'items'</span>]</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>df_highlights <span class="op">=</span> df_highlights.applymap(get_items_value) <span class="co"># only get the description of the item</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df_highlights <span class="op">=</span> df_highlights.rename(columns<span class="op">=</span>{<span class="dv">0</span>: <span class="st">'qualifications'</span>, <span class="dv">1</span>: <span class="st">'responsibilities'</span>, <span class="dv">2</span>: <span class="st">'benefits'</span>}) <span class="co"># rename columns</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_highlights.isna().<span class="bu">sum</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>qualifications        0
responsibilities    105
benefits            400
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>master_df <span class="op">=</span> pd.concat([merged_df, df_highlights], axis <span class="op">=</span> <span class="dv">1</span>) <span class="co"># merge both dataframes by column</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>master_df <span class="op">=</span> master_df.drop([<span class="st">'job_highlights'</span>, <span class="st">'related_links'</span>, <span class="st">'job_id'</span>, <span class="st">'detected_extensions.work_from_home'</span>, <span class="st">'detected_extensions.posted_at'</span>], axis <span class="op">=</span> <span class="dv">1</span>) <span class="co"># drop unneeded columns</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> master_df: <span class="co"># check for nas</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(i, master_df[i].isna().<span class="bu">sum</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>title 0
company_name 0
location 0
via 0
description 0
extensions 0
detected_extensions.schedule_type 1
detected_extensions.salary 690
key 0
qualifications 0
responsibilities 105
benefits 400</code></pre>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#rename columns</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>master_df <span class="op">=</span> master_df.rename(columns<span class="op">=</span>{<span class="st">'detected_extensions.schedule_type'</span>: <span class="st">'schedule_type'</span>, <span class="st">'detected_extensions.salary'</span>: <span class="st">'salary'</span>, <span class="st">'key'</span>: <span class="st">'query'</span>})</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>master_df <span class="op">=</span> master_df.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>master_df.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>title</th>
      <th>company_name</th>
      <th>location</th>
      <th>via</th>
      <th>description</th>
      <th>extensions</th>
      <th>schedule_type</th>
      <th>salary</th>
      <th>query</th>
      <th>qualifications</th>
      <th>responsibilities</th>
      <th>benefits</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ethereum Blockchain Developer (Remote)</td>
      <td>Ex Populus</td>
      <td>Anywhere</td>
      <td>via Built In</td>
      <td>Company Overview:\nEx Populus is a cutting-edg...</td>
      <td>[Work from home, Full-time, No degree mentioned]</td>
      <td>Full-time</td>
      <td>NaN</td>
      <td>block-chain</td>
      <td>[2-3 years of Software Development experience,...</td>
      <td>[Design, maintain and deploy smart contracts f...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Blockchain Engineer</td>
      <td>21.co</td>
      <td>New York, NY</td>
      <td>via Greenhouse</td>
      <td>We are seeking a highly motivated and skilled ...</td>
      <td>[Full-time]</td>
      <td>Full-time</td>
      <td>NaN</td>
      <td>block-chain</td>
      <td>[Bachelor's or Master's degree in Computer Sci...</td>
      <td>[As a Blockchain Engineer, you will be respons...</td>
      <td>[(NYC only) Pursuant to Section 8-102 of title...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Blockchain Course Instructor</td>
      <td>Blockchain Institute of Technology</td>
      <td>Anywhere</td>
      <td>via LinkedIn</td>
      <td>Are you a blockchain, cryptocurrency, NFT, Met...</td>
      <td>[24 hours ago, Work from home, Contractor, No ...</td>
      <td>Contractor</td>
      <td>NaN</td>
      <td>block-chain</td>
      <td>[3+ years of experience in blockchain, cryptoc...</td>
      <td>[Our expert technical team will provide the su...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Python based - Blockchain developer to join ex...</td>
      <td>Upwork</td>
      <td>Anywhere</td>
      <td>via Upwork</td>
      <td>Need someone to join our existing team to spee...</td>
      <td>[2 days ago, 10–30 an hour, Work from home, Co...</td>
      <td>Contractor</td>
      <td>10–30 an hour</td>
      <td>block-chain</td>
      <td>[Candidates must be willing to sign, non-discl...</td>
      <td>[Will discuss details with the selected candid...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Blockchain DevOps Engineer (Remote)</td>
      <td>Telnyx</td>
      <td>United States</td>
      <td>via Startup Jobs</td>
      <td>About Telnyx\n\nAt Telnyx, we’re architecting ...</td>
      <td>[4 days ago, Full-time, No degree mentioned]</td>
      <td>Full-time</td>
      <td>NaN</td>
      <td>block-chain</td>
      <td>[You are a highly motivated and experienced Bl...</td>
      <td>[To build a best-in-class Filecoin (FIL) Minin...</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'query'</span>] <span class="op">=</span> master_df[<span class="st">'query'</span>].<span class="bu">str</span>.replace(<span class="st">'-'</span>, <span class="st">' '</span>) <span class="co"># replace hyphens with spaces</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>master_df.loc[master_df[<span class="st">'query'</span>] <span class="op">==</span> <span class="st">'block chain'</span>, <span class="st">'query'</span>] <span class="op">=</span> <span class="st">'blockchain'</span> <span class="co"># remove space from blockchain</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'via'</span>] <span class="op">=</span> master_df[<span class="st">'via'</span>].<span class="bu">str</span>.<span class="bu">slice</span>(<span class="dv">4</span>) <span class="co"># remove 'via' from the start of the string</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>master_df <span class="op">=</span> master_df.join(master_df[<span class="st">'extensions'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: pd.Series(x)).add_prefix(<span class="st">'ext_'</span>))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>master_df <span class="op">=</span> master_df.drop(<span class="st">'extensions'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>master_df.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>title</th>
      <th>company_name</th>
      <th>location</th>
      <th>via</th>
      <th>description</th>
      <th>schedule_type</th>
      <th>salary</th>
      <th>query</th>
      <th>qualifications</th>
      <th>responsibilities</th>
      <th>benefits</th>
      <th>ext_0</th>
      <th>ext_1</th>
      <th>ext_2</th>
      <th>ext_3</th>
      <th>ext_4</th>
      <th>ext_5</th>
      <th>ext_6</th>
      <th>ext_7</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ethereum Blockchain Developer (Remote)</td>
      <td>Ex Populus</td>
      <td>Anywhere</td>
      <td>Built In</td>
      <td>Company Overview:\nEx Populus is a cutting-edg...</td>
      <td>Full-time</td>
      <td>NaN</td>
      <td>blockchain</td>
      <td>[2-3 years of Software Development experience,...</td>
      <td>[Design, maintain and deploy smart contracts f...</td>
      <td>None</td>
      <td>Work from home</td>
      <td>Full-time</td>
      <td>No degree mentioned</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Blockchain Engineer</td>
      <td>21.co</td>
      <td>New York, NY</td>
      <td>Greenhouse</td>
      <td>We are seeking a highly motivated and skilled ...</td>
      <td>Full-time</td>
      <td>NaN</td>
      <td>blockchain</td>
      <td>[Bachelor's or Master's degree in Computer Sci...</td>
      <td>[As a Blockchain Engineer, you will be respons...</td>
      <td>[(NYC only) Pursuant to Section 8-102 of title...</td>
      <td>Full-time</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Blockchain Course Instructor</td>
      <td>Blockchain Institute of Technology</td>
      <td>Anywhere</td>
      <td>LinkedIn</td>
      <td>Are you a blockchain, cryptocurrency, NFT, Met...</td>
      <td>Contractor</td>
      <td>NaN</td>
      <td>blockchain</td>
      <td>[3+ years of experience in blockchain, cryptoc...</td>
      <td>[Our expert technical team will provide the su...</td>
      <td>None</td>
      <td>24 hours ago</td>
      <td>Work from home</td>
      <td>Contractor</td>
      <td>No degree mentioned</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Python based - Blockchain developer to join ex...</td>
      <td>Upwork</td>
      <td>Anywhere</td>
      <td>Upwork</td>
      <td>Need someone to join our existing team to spee...</td>
      <td>Contractor</td>
      <td>10–30 an hour</td>
      <td>blockchain</td>
      <td>[Candidates must be willing to sign, non-discl...</td>
      <td>[Will discuss details with the selected candid...</td>
      <td>None</td>
      <td>2 days ago</td>
      <td>10–30 an hour</td>
      <td>Work from home</td>
      <td>Contractor</td>
      <td>No degree mentioned</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Blockchain DevOps Engineer (Remote)</td>
      <td>Telnyx</td>
      <td>United States</td>
      <td>Startup Jobs</td>
      <td>About Telnyx\n\nAt Telnyx, we’re architecting ...</td>
      <td>Full-time</td>
      <td>NaN</td>
      <td>blockchain</td>
      <td>[You are a highly motivated and experienced Bl...</td>
      <td>[To build a best-in-class Filecoin (FIL) Minin...</td>
      <td>None</td>
      <td>4 days ago</td>
      <td>Full-time</td>
      <td>No degree mentioned</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'schedule_type'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>array(['Full-time', 'Contractor', 'Internship', 'Part-time', nan],
      dtype=object)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># loop through each row in the dataframe to delete 'days ago' 'hours ago'</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> master_df.iterrows():</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># check if 'ago' is present in ext_0</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'ago'</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'ext_0'</span>]):</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if it is, replace the 'ago' value with the corresponding value from ext_1</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        master_df.at[i, <span class="st">'ext_0'</span>] <span class="op">=</span> row[<span class="st">'ext_1'</span>]</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        master_df.at[i, <span class="st">'ext_1'</span>] <span class="op">=</span> np.nan</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if it isn't, keep the row as it is</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>master_df.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>title                 0
company_name          0
location              0
via                   0
description           0
schedule_type         1
salary              690
query                 0
qualifications        0
responsibilities    105
benefits            400
ext_0                 0
ext_1               641
ext_2               343
ext_3               530
ext_4               670
ext_5               778
ext_6               812
ext_7               819
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>master_df <span class="op">=</span> master_df.drop([<span class="st">'ext_0'</span>, <span class="st">'ext_1'</span>, <span class="st">'ext_2'</span>, <span class="st">'ext_3'</span>, <span class="st">'ext_4'</span>, <span class="st">'ext_5'</span>, <span class="st">'ext_6'</span>, <span class="st">'ext_7'</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> master_df.iterrows(): <span class="co"># go through responsibilities and benefits column to extract salary</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pd.isna(row[<span class="st">'salary'</span>]):</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'$'</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'responsibilities'</span>]):</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'salary'</span>] <span class="op">=</span> row[<span class="st">'responsibilities'</span>]</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">'hour'</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'responsibilities'</span>]):</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'salary'</span>] <span class="op">=</span> row[<span class="st">'responsibilities'</span>]</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">'year'</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'responsibilities'</span>]):</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'salary'</span>] <span class="op">=</span> row[<span class="st">'responsibilities'</span>]</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">'$'</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'benefits'</span>]):</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'salary'</span>] <span class="op">=</span> row[<span class="st">'benefits'</span>]</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">'hour'</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'benefits'</span>]):</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'salary'</span>] <span class="op">=</span> row[<span class="st">'benefits'</span>]</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">'year'</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'benefits'</span>]):</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'salary'</span>] <span class="op">=</span> row[<span class="st">'benefits'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'degree'</span>] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> master_df.iterrows(): <span class="co"># go through responsibilities and benefits column to extract salary</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pd.isna(row[<span class="st">'degree'</span>]):</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"PhD"</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'qualifications'</span>]):</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'degree'</span>] <span class="op">=</span> <span class="st">"PhD"</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"Ph.D."</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'qualifications'</span>]):</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'degree'</span>] <span class="op">=</span> <span class="st">"PhD"</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"Doctorate"</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'qualifications'</span>]):</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'degree'</span>] <span class="op">=</span> <span class="st">"PhD"</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"Master"</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'qualifications'</span>]):</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'degree'</span>] <span class="op">=</span> <span class="st">"Master's"</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"Master's"</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'qualifications'</span>]):</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'degree'</span>] <span class="op">=</span> <span class="st">"Master's"</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"Masters"</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'qualifications'</span>]):</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'degree'</span>] <span class="op">=</span> <span class="st">"Master's"</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"Msc"</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'qualifications'</span>]):</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'degree'</span>] <span class="op">=</span> <span class="st">"Master's"</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"M.A."</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'qualifications'</span>]):</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'degree'</span>] <span class="op">=</span> <span class="st">"Master's"</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"MA"</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'qualifications'</span>]):</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'degree'</span>] <span class="op">=</span> <span class="st">"Master's"</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"MS"</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'qualifications'</span>]):</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'degree'</span>] <span class="op">=</span> <span class="st">"Master's"</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"Advanced"</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'qualifications'</span>]):</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'degree'</span>] <span class="op">=</span> <span class="st">"Master's"</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"M.S."</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'qualifications'</span>]):</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'degree'</span>] <span class="op">=</span> <span class="st">"Master's"</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"Bachelor's"</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'qualifications'</span>]):</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'degree'</span>] <span class="op">=</span> <span class="st">"Bachelor's"</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"BS"</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'qualifications'</span>]):</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'degree'</span>] <span class="op">=</span> <span class="st">"Bachelor's"</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"B.S."</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'qualifications'</span>]):</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'degree'</span>] <span class="op">=</span> <span class="st">"Bachelor's"</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"BA"</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'qualifications'</span>]):</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'degree'</span>] <span class="op">=</span> <span class="st">"Bachelor's"</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"B.A."</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'qualifications'</span>]):</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'degree'</span>] <span class="op">=</span> <span class="st">"Bachelor's"</span></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"Bachelors"</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'qualifications'</span>]):</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'degree'</span>] <span class="op">=</span> <span class="st">"Bachelor's"</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"Bachelor"</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'qualifications'</span>]):</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'degree'</span>] <span class="op">=</span> <span class="st">"Bachelor's"</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"Undergraduate"</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'qualifications'</span>]):</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>            master_df.at[i, <span class="st">'degree'</span>] <span class="op">=</span> <span class="st">"Bachelor's"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'salary'</span>] <span class="op">=</span> master_df[<span class="st">'salary'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">str</span>(x) <span class="cf">if</span> <span class="bu">isinstance</span>(x, <span class="bu">list</span>) <span class="cf">else</span> x) <span class="co"># convert salary to string </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_salary(salary):</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if salary is a list, extract the salary range from the appropriate string</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(salary, <span class="bu">list</span>):</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> s <span class="kw">in</span> salary:</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">"salary range"</span> <span class="kw">in</span> s.lower():</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>                salary <span class="op">=</span> re.findall(<span class="vs">r"\$\d+(?:,\d+)*(?:\.\d+)?"</span>, s)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>                salary <span class="op">=</span> <span class="st">" - "</span>.join(salary)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if salary is a string, extract the salary range</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="bu">isinstance</span>(salary, <span class="bu">str</span>):</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>        salary <span class="op">=</span> re.findall(<span class="vs">r"\$\d+(?:,\d+)*(?:\.\d+)?"</span>, salary)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>        salary <span class="op">=</span> <span class="st">" - "</span>.join(salary)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>        salary <span class="op">=</span> np.nan</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> salary</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_time_period(salary):</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(salary, <span class="bu">str</span>):</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"hour"</span> <span class="kw">in</span> salary:</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>            time_period <span class="op">=</span> <span class="st">"an hour"</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"month"</span> <span class="kw">in</span> salary:</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>            time_period <span class="op">=</span> <span class="st">"a month"</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"year"</span> <span class="kw">in</span> salary:</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>            time_period <span class="op">=</span> <span class="st">"a year"</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>            time_period <span class="op">=</span> np.nan</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>        time_period <span class="op">=</span> np.nan</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> time_period</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">"salary_cleaned"</span>] <span class="op">=</span> master_df[<span class="st">"salary"</span>].<span class="bu">apply</span>(clean_salary)</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">"time_period"</span>] <span class="op">=</span> master_df[<span class="st">"salary_cleaned"</span>].<span class="bu">apply</span>(extract_time_period)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># iterate over every row in the dataframe</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index, row <span class="kw">in</span> master_df.iterrows():</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># check if the 'salary_cleaned' value contains '$'</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'$'</span> <span class="kw">in</span> <span class="bu">str</span>(row[<span class="st">'salary_cleaned'</span>]):</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># assign the entire value to the 'salary' column</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>        master_df.at[index, <span class="st">'salary'</span>] <span class="op">=</span> row[<span class="st">'salary_cleaned'</span>] <span class="co">#####</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove list values from salary</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># create a boolean mask to filter out missing values </span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>not_null_mask <span class="op">=</span> pd.notnull(master_df[<span class="st">'salary'</span>]) </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># find the rows where 'salary' contains '['</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>rows_with_brackets <span class="op">=</span> master_df[not_null_mask <span class="op">&amp;</span> master_df[<span class="st">'salary'</span>].<span class="bu">str</span>.contains(<span class="st">'</span><span class="ch">\\</span><span class="st">['</span>)]</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co"># set the 'salary' column to NaN for the rows with brackets</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>master_df.loc[rows_with_brackets.index, <span class="st">'salary'</span>] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'salary'</span>] <span class="op">=</span> master_df[<span class="st">'salary'</span>].<span class="bu">str</span>.replace(<span class="st">'–'</span>, <span class="st">'-'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a boolean mask to filter for rows containing 'hour'</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> master_df[<span class="st">'salary'</span>].<span class="bu">str</span>.contains(<span class="st">'hour'</span>, na<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># select the rows where 'salary' contains 'hour'</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>rows_with_hourly_wage <span class="op">=</span> master_df[mask]</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># convert hourly wage to annual salary</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, row <span class="kw">in</span> rows_with_hourly_wage.iterrows():</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    salary_str <span class="op">=</span> row[<span class="st">'salary'</span>]</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> salary_str.count(<span class="st">'-'</span>) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle case where salary range is given</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>        salary_range <span class="op">=</span> salary_str.split(<span class="st">' '</span>)[<span class="dv">0</span>]</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>        salary_range <span class="op">=</span> salary_range.replace(<span class="st">'</span><span class="ch">\u2011</span><span class="st">'</span>, <span class="st">'-'</span>)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>        start, end <span class="op">=</span> <span class="bu">map</span>(<span class="bu">float</span>, salary_range.split(<span class="st">'-'</span>))</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>        avg_salary <span class="op">=</span> (start <span class="op">+</span> end) <span class="op">/</span> <span class="fl">2.0</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>        annual_salary <span class="op">=</span> avg_salary <span class="op">*</span> <span class="dv">2080</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>        master_df.loc[idx, <span class="st">'salary'</span>] <span class="op">=</span> <span class="st">'${:,.2f}'</span>.<span class="bu">format</span>(annual_salary)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> salary_str.count(<span class="st">'-'</span>) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle case where single hourly wage is given</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>        hourly_wage_str <span class="op">=</span> salary_str.split(<span class="st">' '</span>)[<span class="dv">0</span>]</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>        hourly_wage <span class="op">=</span> <span class="bu">float</span>(hourly_wage_str)</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>        annual_salary <span class="op">=</span> hourly_wage <span class="op">*</span> <span class="dv">2080</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>        master_df.loc[idx, <span class="st">'salary'</span>] <span class="op">=</span> <span class="st">'${:,.2f}'</span>.<span class="bu">format</span>(annual_salary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'salary'</span>] <span class="op">=</span> master_df[<span class="st">'salary'</span>].<span class="bu">str</span>.replace(<span class="st">' a year'</span>, <span class="st">''</span>).<span class="bu">str</span>.strip()</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'salary'</span>] <span class="op">=</span> master_df[<span class="st">'salary'</span>].<span class="bu">str</span>.replace(<span class="st">'$'</span>, <span class="st">''</span>).<span class="bu">str</span>.strip()</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>master_df.loc[<span class="dv">636</span>, <span class="st">'salary'</span>] <span class="op">=</span> <span class="dv">136284</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>master_df.loc[<span class="dv">761</span>, <span class="st">'salary'</span>] <span class="op">=</span> <span class="dv">22070</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>master_df.loc[<span class="dv">681</span>, <span class="st">'salary'</span>] <span class="op">=</span> <span class="dv">121000</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>master_df.loc[<span class="dv">746</span>, <span class="st">'salary'</span>] <span class="op">=</span> <span class="dv">206000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/37/fsk42jds3255qblrs5r1v99c0000gn/T/ipykernel_24850/4119749001.py:2: FutureWarning:

The default value of regex will change from True to False in a future version. In addition, single character regular expressions will *not* be treated as literal strings when regex=True.
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>num_nas <span class="op">=</span> master_df[<span class="st">'salary'</span>].isna().<span class="bu">sum</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of NaN values in 'salary' column: </span><span class="sc">{</span>num_nas<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of NaN values in 'salary' column: 473</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function to convert salary ranges to their average values</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'salary'</span>] <span class="op">=</span> master_df[<span class="st">'salary'</span>].astype(<span class="bu">str</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_salary_range(s):</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'-'</span> <span class="kw">in</span> s:</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> s.replace(<span class="st">'$'</span>, <span class="st">''</span>).replace(<span class="st">','</span>, <span class="st">''</span>).replace(<span class="st">'K'</span>, <span class="st">'000'</span>).replace(<span class="st">'k'</span>, <span class="st">'000'</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>        parts <span class="op">=</span> s.split(<span class="st">'-'</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>        parts <span class="op">=</span> [<span class="bu">float</span>(p) <span class="cf">for</span> p <span class="kw">in</span> parts <span class="cf">if</span> <span class="kw">not</span> pd.isnull(p)]</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>        avg <span class="op">=</span> <span class="bu">sum</span>(parts) <span class="op">/</span> <span class="bu">len</span>(parts)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> avg</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> s</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the function to the 'salary' column of master_df</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'salary'</span>] <span class="op">=</span> master_df[<span class="st">'salary'</span>].<span class="bu">apply</span>(parse_salary_range)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'salary'</span>] <span class="op">=</span> master_df[<span class="st">'salary'</span>].astype(<span class="bu">str</span>)  <span class="co"># convert all data points to string type</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'salary'</span>] <span class="op">=</span> master_df[<span class="st">'salary'</span>].<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>)  <span class="co"># remove commas</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'salary'</span>] <span class="op">=</span> master_df[<span class="st">'salary'</span>].<span class="bu">str</span>.replace(<span class="st">'\.\d+'</span>, <span class="st">''</span>)  <span class="co"># remove decimals and everything after them</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'salary'</span>] <span class="op">=</span> pd.to_numeric(master_df[<span class="st">'salary'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'salary'</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/37/fsk42jds3255qblrs5r1v99c0000gn/T/ipykernel_24850/1948180007.py:3: FutureWarning:

The default value of regex will change from True to False in a future version.
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>count       347.000000
mean     125612.092219
std       73116.788777
min           0.000000
25%       59013.000000
50%      134500.000000
75%      175000.000000
max      400000.000000
Name: salary, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'qualifications'</span>] <span class="op">=</span> master_df[<span class="st">'qualifications'</span>].astype(<span class="bu">str</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_experience(text):</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    match <span class="op">=</span> re.search(<span class="vs">r'(\d[\d+-]*\s*(?:year|yr|yrs|years))'</span>, text, re.IGNORECASE)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> match:</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> match.group(<span class="dv">1</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'experience'</span>] <span class="op">=</span> master_df[<span class="st">'qualifications'</span>].<span class="bu">apply</span>(extract_experience)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'experience'</span>] <span class="op">=</span> master_df[<span class="st">'experience'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">str</span>(x))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_experience(exp):</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(exp, <span class="bu">str</span>):</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract digits from the experience string</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>        digits <span class="op">=</span> re.findall(<span class="st">'\d+'</span>, exp)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(digits) <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate the average of two numbers if there are two digits</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>            avg_exp <span class="op">=</span> (<span class="bu">int</span>(digits[<span class="dv">0</span>]) <span class="op">+</span> <span class="bu">int</span>(digits[<span class="dv">1</span>])) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="bu">len</span>(digits) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Take the single digit if there is only one digit</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>            avg_exp <span class="op">=</span> <span class="bu">int</span>(digits[<span class="dv">0</span>])</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Return None if there are no digits</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> avg_exp</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Return None if the input is not a string</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'experience'</span>] <span class="op">=</span> master_df[<span class="st">'experience'</span>].<span class="bu">apply</span>(clean_experience)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>master_df <span class="op">=</span> master_df.drop([<span class="st">'salary_cleaned'</span>, <span class="st">'time_period'</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>master_df.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>title                 0
company_name          0
location              0
via                   0
description           0
schedule_type         1
salary              476
query                 0
qualifications        0
responsibilities    105
benefits            400
degree              287
experience          436
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>min_count <span class="op">=</span> master_df.count().<span class="bu">min</span>()</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Number of rows with entries for every column:"</span>, min_count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of rows with entries for every column: 347</code></pre>
</div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'degree'</span>] <span class="op">=</span> master_df[<span class="st">'degree'</span>].astype(<span class="st">'category'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>master_df.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>title                 object
company_name          object
location              object
via                   object
description           object
schedule_type         object
salary               float64
query                 object
qualifications        object
responsibilities      object
benefits              object
degree              category
experience           float64
dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'location'</span>] <span class="op">=</span> master_df[<span class="st">'location'</span>].<span class="bu">str</span>.strip() <span class="co"># delete extra spaces</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>master_df[<span class="st">'remote'</span>] <span class="op">=</span> master_df[<span class="st">'location'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="va">True</span> <span class="cf">if</span> x <span class="kw">in</span> [<span class="st">'Anywhere'</span>, <span class="st">'United States'</span>] <span class="cf">else</span> <span class="va">False</span>) <span class="co"># make 'remote' dummy variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>master_df.loc[[<span class="dv">26</span>, <span class="dv">58</span>, <span class="dv">73</span>, <span class="dv">77</span>, <span class="dv">127</span>, <span class="dv">230</span>, <span class="dv">271</span>, <span class="dv">322</span>, <span class="dv">463</span>, <span class="dv">472</span>, <span class="dv">651</span>, <span class="dv">731</span>, <span class="dv">763</span>, <span class="dv">768</span>, <span class="dv">781</span>], <span class="st">'salary'</span>] <span class="op">=</span> np.nan <span class="co"># delete bonuses that were detected as salaries</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>master_df.loc[[<span class="dv">48</span>, <span class="dv">110</span>, <span class="dv">193</span>, <span class="dv">264</span>, <span class="dv">614</span>, <span class="dv">654</span>], <span class="st">'salary'</span>] <span class="op">*=</span> <span class="dv">2080</span> <span class="co"># convert unconverted hourly salaries</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>master_df.loc[[<span class="dv">108</span>, <span class="dv">143</span>, <span class="dv">151</span>, <span class="dv">231</span>, <span class="dv">249</span>, <span class="dv">340</span>, <span class="dv">350</span>, <span class="dv">357</span>, <span class="dv">396</span>, <span class="dv">426</span>, <span class="dv">525</span>, <span class="dv">542</span>, <span class="dv">557</span>, <span class="dv">627</span>, <span class="dv">737</span>, <span class="dv">758</span>, <span class="dv">808</span>], <span class="st">'salary'</span>] <span class="op">*=</span> <span class="dv">1000</span> <span class="co"># salaries read as 240 instead of 240000</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>master_df.loc[[<span class="dv">251</span>, <span class="dv">696</span>], <span class="st">'salary'</span>] <span class="op">*=</span> <span class="dv">12</span> <span class="co"># convert unconverted monthly salaries</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>master_df.to_csv(<span class="st">'job_data.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>